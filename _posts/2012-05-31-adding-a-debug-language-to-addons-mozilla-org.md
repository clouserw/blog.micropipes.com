---
layout: post
title: Adding a debug language to ȧḓḓ-ǿƞş.ḿǿzīŀŀȧ.ǿřɠ
tags:
- Mozilla
---
<p><a href="/blog/public/img/amo-dbg.png"><img src="/blog/public/img/amo-dbg.png" title="AMO Debug language; Screenshot" /></a>Last week <a href="http://gkoberger.net/">Greg Koberger</a> finally got me to cross "add a test locale to AMO" off my list - and it turns out it only took a few minutes of actual coding.  It sounds like others have had some troubles so I wanted to run through what I did.</p>
<p>Firstly, you can see what I'm talking about at <a href="https://addons-dev.allizom.org/dbg/firefox">the AMO dev site</a>.  I'm using a script in the Translate Toolkit called <a href="http://translate.sourceforge.net/wiki/toolkit/podebug">podebug</a> to generate a .po file filled with unicode characters.  You can also generate one which surrounds the strings with "xxx" or blanks them out, etc.  The goal is to easily see what strings on your website can't be localized (this means they aren't in the .po files for localizers).</p>
<p>If you're using <a href="http://svn.mozilla.org/libs/product-details/">product-details</a> to get locale names make sure you're using the latest revision - I added <em>dbg</em> to the array so it will show up in language dropdowns like all the other languages.  After that I added <em>dbg</em> to Django's LANGUAGES define[1].  At that point the language showed up, but we'd get tracebacks if we tried to format money in a string since 'dbg' was a fake language.  AMO uses <a href="http://babel.edgewall.org/">Babel</a> for details about each locale so I just made a wrapper for the Babel Locale() function and told it to use 'en' if it saw 'dbg'.  This way 'dbg' is used for all the strings on the site but for any complex formatting we fall back to en.  This works since dbg is based off en anyway, as far as pluralizations are concerned.  You can see my commit which added that function and made sure we started using it <a href="https://github.com/mozilla/zamboni/commit/453a61693dafaa8bc1f5cc52216c656c6bbfd244">here</a>.</p>
<p>This also works <a href="https://marketplace-dev.allizom.org/dbg/">on the marketplace</a>.</p>
<p>[1] I actually added it to AMO_LANGUAGES which gets to LANGUAGES in a slightly round-about way.  See <a href="https://github.com/mozilla/zamboni/blob/553a31ca7794122df8bf52b781a0bc7b64ab753f/lib/settings_base.py#L101">our settings.py file</a> for how that flow works.</p>
